<!doctype html><html lang="ja"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>RigNavi</title>
<!-- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æŠ‘æ­¢ï¼ˆGitHub Pagesã§ã‚‚åŠ¹ãç¯„å›²ã§ï¼‰ -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{
  /* æ˜ã‚‹ã‚é…è‰² */
  --bg1:#f5f9ff; --bg2:#eef6ff;
  --card:#ffffff; --line:#d9e6f6;
  --txt:#0b1b2b; --muted:#506172;
  --pri:#0ea5e9; --pri2:#22d3ee; --shadow:0 6px 18px rgba(13,97,160,.12);
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;font-family:Inter,system-ui,Segoe UI,Helvetica,Arial;
  background:linear-gradient(180deg,var(--bg1),var(--bg2)); color:var(--txt);}
.container{max-width:900px;margin:0 auto;padding:18px}
.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.brand{font-weight:700;letter-spacing:.2px}
.badge{color:#003244;background:linear-gradient(90deg,var(--pri),var(--pri2));
  padding:4px 10px;border-radius:999px;font-size:12px;font-weight:700}
.hello{color:var(--muted);margin:2px 0 14px}

.stepper{display:flex;gap:10px;margin:8px 0 16px}
.step{flex:1;background:#fff;border:1px solid var(--line);color:var(--muted);
  padding:10px 12px;border-radius:12px;display:flex;align-items:center;gap:8px;box-shadow:var(--shadow)}
.step.active{border-color:var(--pri); color:#024c66;
  background:linear-gradient(180deg,#ffffff,#f0fbff)}
.step .num{width:22px;height:22px;border-radius:999px;background:#eef7ff;
  display:grid;place-items:center;font-size:12px;color:#0678a3;font-weight:700}

.grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
@media(min-width:720px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}

.card{background:var(--card);border:1px solid var(--line);border-radius:14px;
  padding:14px;box-shadow:var(--shadow);transition:.15s transform}
.card:hover{transform:translateY(-2px)}
.card h3{margin:0 0 6px;font-size:16px}
.card p{margin:0;color:var(--muted);font-size:13px}

.chip{display:inline-block;padding:6px 10px;border-radius:999px;
  background:#e6f7ff;border:1px solid #bfeaff;color:#06678e;font-size:12px}
.btn{background:linear-gradient(90deg,var(--pri),var(--pri2));border:none;color:#003244;
  font-weight:700;padding:12px 14px;border-radius:10px;box-shadow:var(--shadow)}
.btn.secondary{background:#ffffff;color:#0b1b2b;border:1px solid var(--line)}

.section{background:var(--card);border:1px solid var(--line);border-radius:16px;
  padding:16px;box-shadow:var(--shadow)}
.section h2{margin:0 0 10px}

.row{display:flex;gap:10px;flex-wrap:wrap}
.item{flex:1 1 240px;border:1px dashed #b9d6ea;border-radius:10px;padding:10px;background:#fcfeff}
a.clean{color:inherit;text-decoration:none}
.mono{font-family:ui-monospace,Menlo,Consolas,monospace}
.small{font-size:12px;color:var(--muted)}
.hero{width:100%;border-radius:12px;margin:6px 0;aspect-ratio:16/9;object-fit:cover;border:1px solid var(--line)}
</style>
</head><body>
<div class="container">
  <div class="header">
    <div class="brand">ğŸ£ RigNavi</div>
    <div class="badge">MVP</div>
  </div>
  <div id="hello" class="hello">èµ·å‹•ä¸­...</div>

  <div class="stepper">
    <div class="step" id="s1"><span class="num">1</span>é‡£ã‚Šå ´æ‰€</div>
    <div class="step" id="s2"><span class="num">2</span>é­šç¨®</div>
    <div class="step" id="s3"><span class="num">3</span>é‡£ã‚Šæ–¹</div>
  </div>

  <div id="view"></div>
</div>

<script>
const LIFF_ID   = "2008257307-RwPLYWG1";
const VERSION   = "2";  // â†ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãŸã³ã«ä¸Šã’ã‚‹
const LIFF_URL  = `https://liff.line.me/${LIFF_ID}?v=${VERSION}`;

// --- ãƒ‡ãƒ¼ã‚¿ï¼ˆå¿…è¦ã«å¿œã˜ã¦å¢—ã‚„ã—ã¦ãã ã•ã„ï¼‰ ---
const DB = [
  { id:"teibo", name:"æ¸¯ãƒ»å ¤é˜²", desc:"å¸¸å¤œç¯ã‚„è§’åœ°ã€å¤–å‘ããƒ†ãƒˆãƒ©ãªã©",
    fishes:[
      { id:"aji", name:"ã‚¢ã‚¸", desc:"å¤•ã¾ãšã‚ã€œå¤œã®å›éŠ",
        methods:[
          { id:"sabiki", name:"ã‚µãƒ“ã‚­",
            plan:{
              title:"ã‚¢ã‚¸ã®æ•°é‡£ã‚Šï¼ˆå ¤é˜²ã‚µãƒ“ã‚­ï¼‰",
              hero:"https://images.unsplash.com/photo-1524712245354-c8471b98e76c?q=80&w=1200&auto=format&fit=crop",
              point:"å¸¸å¤œç¯ã®æ˜æš—å¢ƒãƒ»è¶³å…ƒå›éŠã®è¡¨å±¤ã€œä¸­å±¤",
              depth:"è¡¨å±¤ã€œä¸­å±¤ï¼ˆã‚«ã‚´ã‚’1måˆ»ã¿ã§æ¢ã‚‹ï¼‰",
              how:"10å›/åˆ†ã®ãƒ†ãƒ³ãƒã§ä¸Šä¸‹ã€‚ç¾¤ã‚ŒãŒä»˜ã„ãŸå±¤ã‚’ã‚­ãƒ¼ãƒ—ã€‚",
              gear:{ rig:"ã‚µãƒ“ã‚­6æœ¬ 4ã€œ6å· + å°å‹ã‚«ã‚´", line:"ãƒŠã‚¤ãƒ­ãƒ³2ã€œ3å· / ãƒãƒªã‚¹1.5å·", option:"å¤œã¯ã‚±ãƒŸå°ã§è¦–èªæ€§UP" },
              parts:[
                {label:"ãƒãƒ¤ãƒ–ã‚µ ã‚µãƒ“ã‚­5å·", url:"https://www.amazon.co.jp/s?k=%E3%82%B5%E3%83%93%E3%82%AD+5%E5%8F%B7&tag=yourtag-22"},
                {label:"ã‚«ã‚´å° ãƒŠã‚¹å‹8å·", url:"https://www.amazon.co.jp/s?k=%E9%87%A3%E3%82%8A+%E3%82%AB%E3%82%B4+%E5%B0%8F&tag=yourtag-22"}
              ]
            }
          },
          { id:"uki", name:"ã‚¦ã‚­",
            plan:{
              title:"é›»æ°—ã‚¦ã‚­ã§å›éŠå¾…ã¡",
              hero:"https://images.unsplash.com/photo-1508855901852-97c5b3b5b6cd?q=80&w=1200&auto=format&fit=crop",
              point:"å¸¸å¤œç¯å‘¨è¾ºã®æ½®ãŒåŠ¹ãç­‹",
              depth:"1.0ã€œ1.8mã§å¾®èª¿æ•´",
              how:"ã‚¦ã‚­ä¸‹ã‚’30cmåˆ»ã¿ã§èª¿æ•´ã€‚æ™‚ã€…ã‚†ã£ãã‚Šå¼•ãã€‚",
              gear:{ rig:"é›»æ°—ã‚¦ã‚­0.5ã€œ1å·", line:"ãƒŠã‚¤ãƒ­ãƒ³3å·", option:"èª˜ã„ç”¨ã‚¬ãƒ³ç‰G5" },
              parts:[
                {label:"é›»æ°—ã‚¦ã‚­ 1å·", url:"https://www.amazon.co.jp/s?k=%E9%9B%BB%E6%B0%97%E3%82%A6%E3%82%AD+1%E5%8F%B7&tag=yourtag-22"},
                {label:"ã‚µãƒ«ã‚«ãƒ³/ãƒãƒªã‚¹", url:"https://www.amazon.co.jp/s?k=%E3%82%B5%E3%83%AB%E3%82%AB%E3%83%B3+%E3%83%8F%E3%83%AA%E3%82%B9&tag=yourtag-22"}
              ]
            }
          }
        ]
      },
      { id:"mebaru", name:"ãƒ¡ãƒãƒ«", desc:"å²©å ´ãƒ»ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ãƒ¼å‘¨ã‚Š",
        methods:[
          { id:"lure", name:"ãƒ«ã‚¢ãƒ¼",
            plan:{
              title:"å¸¸å¤œç¯ãƒ¡ãƒãƒªãƒ³ã‚°",
              hero:"https://images.unsplash.com/photo-1558981285-6f0c94958bb6?q=80&w=1200&auto=format&fit=crop",
              point:"å£éš›/æ˜æš—å¢ƒ/åè»¢æµ",
              depth:"è¡¨å±¤ãƒ‰ãƒªãƒ•ãƒˆ â†’ ä¸­å±¤ãƒ¬ãƒ³ã‚¸ã‚­ãƒ¼ãƒ—",
              how:"1gã‚¸ã‚°ãƒ˜ãƒƒãƒ‰ï¼‹ãƒ¯ãƒ¼ãƒ ã§è¶…ã‚¹ãƒ­ãƒ¼å·»ã",
              gear:{ rig:"1gã‚¸ã‚°ãƒ˜ãƒƒãƒ‰ï¼‹1.5inãƒ¯ãƒ¼ãƒ ", line:"PE0.2 + ï¾Œï¾›ï¾›0.8", option:"ã‚¹ãƒŠãƒƒãƒ—å°ã§äº¤æ›æ¥½ã«" },
              parts:[
                {label:"1g ã‚¸ã‚°ãƒ˜ãƒƒãƒ‰", url:"https://www.amazon.co.jp/s?k=%E3%82%B8%E3%82%B0%E3%83%98%E3%83%83%E3%83%89+1g&tag=yourtag-22"},
                {label:"ãƒ¡ãƒãƒ«ãƒ¯ãƒ¼ãƒ 1.5in", url:"https://www.amazon.co.jp/s?k=%E3%83%A1%E3%83%90%E3%83%AA+%E3%83%AF%E3%83%BC%E3%83%A0&tag=yourtag-22"}
              ]
            }
          }
        ]
      }
    ]
  },
  { id:"surf", name:"ã‚µãƒ¼ãƒ•", desc:"é æµ…ã®ç ‚æµœã€‚æ‰•ã„å‡ºã—/é›¢å²¸æµãŒç‹™ã„ç›®",
    fishes:[
      { id:"hirame", name:"ãƒ’ãƒ©ãƒ¡", desc:"æœå¤•ã¾ãšã‚ä¸­å¿ƒ",
        methods:[ { id:"lure", name:"ãƒ«ã‚¢ãƒ¼",
          plan:{
            title:"ãƒ•ãƒ©ãƒƒãƒˆã‚²ãƒ¼ãƒ ï¼ˆãƒŸãƒãƒ¼/ã‚·ãƒ³ãƒšãƒ³ï¼‰",
            hero:"https://images.unsplash.com/photo-1455216205476-8e8b3410dde6?q=80&w=1200&auto=format&fit=crop",
            point:"é›¢å²¸æµã®ãƒ¨ãƒ¬ãƒ»åœ°å½¢å¤‰åŒ–ãƒ©ã‚¤ãƒ³",
            depth:"ä¸­å±¤ã€œãƒœãƒˆãƒ ä»˜è¿‘",
            how:"ãŸã å·»ãï¼‹æ™‚ã€…ã‚¹ãƒˆãƒƒãƒ—ã€‚æ³¢æ‰“ã¡éš›ã¾ã§é€šã™ã€‚",
            gear:{ rig:"30gã‚·ãƒ³ãƒšãƒ³/ãƒŸãƒãƒ¼", line:"PE1.0 + ï¾Œï¾›ï¾›4", option:"ã‚¹ãƒŠãƒƒãƒ—#1" },
            parts:[
              {label:"ã‚·ãƒ³ãƒšãƒ³ 30g", url:"https://www.amazon.co.jp/s?k=%E3%82%B7%E3%83%B3%E3%83%9A%E3%83%B3+30g&tag=yourtag-22"},
              {label:"ã‚·ãƒ§ãƒƒã‚¯ãƒªãƒ¼ãƒ€ãƒ¼4å·", url:"https://www.amazon.co.jp/s?k=%E3%83%AA%E3%83%BC%E3%83%80%E3%83%BC+4%E5%8F%B7+%E3%83%95%E3%83%AD%E3%83%AD&tag=yourtag-22"}
            ]
          }
        } ]
      }
    ]
  }
];

// ====== çŠ¶æ…‹ & ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° ======
let state = {spot:null, fish:null, method:null};
function setState(part, val){
  state[part] = val;
  const hash = [state.spot?.id, state.fish?.id, state.method?.id].filter(Boolean).join('/');
  location.hash = hash ? `#${hash}` : '#';
  render();
}
function initFromHash(){
  const [sid,fid,mid] = (location.hash.replace('#','')||'').split('/');
  const spot   = DB.find(s=>s.id===sid);
  const fish   = spot?.fishes.find(f=>f.id===fid);
  const method = fish?.methods.find(m=>m.id===mid);
  state = {spot, fish, method};
}

// ====== ãƒ“ãƒ¥ãƒ¼ ======
const $view = document.getElementById('view');
function stepActive(n){ [1,2,3].forEach(i=>document.getElementById('s'+i).classList.toggle('active', i===n)); }

function viewSpots(){
  stepActive(1);
  $view.innerHTML = `<div class="grid">
    ${DB.map(s=>`<a class="clean" href="javascript:void(0)" onclick="pickSpot('${s.id}')">
      <div class="card"><h3>${s.name}</h3><p>${s.desc}</p></div></a>`).join('')}
  </div>`;
}
window.pickSpot = (sid)=>{ setState('spot', DB.find(s=>s.id===sid)); setState('fish',null); setState('method',null); };

function viewFish(){
  stepActive(2);
  const list = state.spot.fishes;
  $view.innerHTML = `<div class="section">
    <h2>${state.spot.name} <span class="chip">é­šç¨®ã‚’é¸ã¶</span></h2>
    <div class="grid" style="margin-top:10px;">
      ${list.map(f=>`<a class="clean" href="javascript:void(0)" onclick="pickFish('${f.id}')">
        <div class="card"><h3>${f.name}</h3><p>${f.desc}</p></div></a>`).join('')}
    </div>
    <div class="small" style="margin-top:10px">æˆ»ã‚‹: <a class="clean mono" href="javascript:setState('spot',null)">#TOP</a></div>
  </div>`;
}
window.pickFish = (fid)=>{ setState('fish', state.spot.fishes.find(f=>f.id===fid)); setState('method',null); };

function viewMethods(){
  stepActive(3);
  const list = state.fish.methods;
  $view.innerHTML = `<div class="section">
    <h2>${state.spot.name} â€º ${state.fish.name} <span class="chip">é‡£ã‚Šæ–¹ã‚’é¸ã¶</span></h2>
    <div class="grid" style="margin-top:10px;">
      ${list.map(m=>`<a class="clean" href="javascript:void(0)" onclick="pickMethod('${m.id}')">
        <div class="card"><h3>${m.name}</h3><p>${m.plan.title}</p></div></a>`).join('')}
    </div>
  </div>`;
}
window.pickMethod = (mid)=>{ setState('method', state.fish.methods.find(m=>m.id===mid)); };

function viewPlan(){
  const {spot, fish, method} = state; const p = method.plan;
  $view.innerHTML = `
    <div class="section">
      <div class="small">ãƒ«ãƒ¼ãƒˆ: <span class="mono">#${spot.id}/${fish.id}/${method.id}</span></div>
      <h2 style="margin-top:6px">${spot.name} â€º ${fish.name} â€º <span class="chip">${method.name}</span></h2>
      <img class="hero" src="${p.hero}" alt="">
      <div class="row">
        <div class="item"><b>ç‹™ã†ãƒã‚¤ãƒ³ãƒˆ</b><br>${p.point}</div>
        <div class="item"><b>ç‹™ã†æ£š</b><br>${p.depth}</div>
        <div class="item"><b>æ”»ã‚æ–¹ã®ã‚³ãƒ„</b><br>${p.how}</div>
      </div>
      <div class="row" style="margin-top:10px">
        <div class="item"><b>ä»•æ›ã‘</b><br>${p.gear.rig}</div>
        <div class="item"><b>ãƒ©ã‚¤ãƒ³</b><br>${p.gear.line}</div>
        <div class="item"><b>ã‚ªãƒ—ã‚·ãƒ§ãƒ³</b><br>${p.gear.option||'-'}</div>
      </div>
      <h3 style="margin:14px 0 8px">ãŠã™ã™ã‚éƒ¨æ</h3>
      <div class="grid">
        ${p.parts.map(it=>`<div class="card">
          <h3>${it.label}</h3><p class="small">Amazonã§è©³ç´°ã‚’ç¢ºèª</p>
          <button class="btn" onclick="ext('${it.url}')">Amazonã§è¦‹ã‚‹</button>
        </div>`).join('')}
      </div>
      <div style="display:flex; gap:8px; margin-top:14px">
        <button class="btn secondary" onclick="historyBack()">æˆ»ã‚‹</button>
        <button class="btn" onclick="sharePlan()">å‹ã ã¡ã«å…±æœ‰</button>
      </div>
    </div>`;
}
window.ext = (url)=> liff.openWindow({ url, external:true });
window.historyBack = ()=>{ if(state.method){ setState('method',null); } else if(state.fish){ setState('fish',null);} else { setState('spot',null);} };

function sharePlan(){
  const {spot, fish, method} = state; const p = method.plan;
  if(!liff.isApiAvailable('shareTargetPicker')){ alert('å…±æœ‰ã¯LINEã‚¢ãƒ—ãƒªã‹ã‚‰'); return; }
  const btns = [
    {type:"button", style:"primary", action:{type:"uri", label:"Amazonã§è¦‹ã‚‹", uri:p.parts[0]?.url || LIFF_URL}},
    {type:"button", style:"secondary", action:{type:"uri", label:"RigNaviã§é–‹ã", uri:`${LIFF_URL}#${spot.id}/${fish.id}/${method.id}`}}
  ];
  if(p.parts[1]) btns.unshift({type:"button", style:"primary", action:{type:"uri", label:"ã‚‚ã†1ä»¶", uri:p.parts[1].url}});
  const flex = {
    type:"bubble",
    hero:{type:"image",url:p.hero,size:"full",aspectMode:"cover",aspectRatio:"16:9"},
    body:{type:"box",layout:"vertical",contents:[
      {type:"text",text:p.title,weight:"bold",wrap:true},
      {type:"text",text:`å ´æ‰€:${spot.name} / é­š:${fish.name} / é‡£æ³•:${method.name}`,size:"sm",color:"#666666",wrap:true,margin:"sm"},
      {type:"text",text:`ãƒã‚¤ãƒ³ãƒˆ:${p.point}`,wrap:true,size:"sm",margin:"md"},
      {type:"text",text:`æ£š:${p.depth}`,wrap:true,size:"sm"},
    ]},
    footer:{type:"box",layout:"vertical",spacing:"md",contents:btns}
  };
  liff.shareTargetPicker([{type:"flex",altText:p.title,contents:flex}]);
}

// ====== ç”»é¢åˆ‡æ›¿ ======
function render(){
  const s = state;
  document.getElementById('s1').classList.toggle('active',!s.spot);
  document.getElementById('s2').classList.toggle('active',s.spot && !s.fish);
  document.getElementById('s3').classList.toggle('active',s.fish && !s.method);
  if(!s.spot) return viewSpots();
  if(!s.fish) return viewFish();
  if(!s.method) return viewMethods();
  return viewPlan();
}

// ====== èµ·å‹• ======
(async()=>{
  await liff.init({ liffId: LIFF_ID });
  if(!liff.isLoggedIn()){ liff.login({prompt:'consent'}); return; }
  try{ const p=await liff.getProfile(); document.getElementById('hello').textContent=`ã‚ˆã†ã“ã ${p.displayName} ã•ã‚“`; }
  catch{ document.getElementById('hello').textContent='ã‚ˆã†ã“ãï¼'; }
  initFromHash(); render();
})();
window.addEventListener('hashchange',()=>{ initFromHash(); render();});
</script>
</body></html>
