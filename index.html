<!doctype html><html lang="ja"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>RigNavi</title>
<!-- „Ç≠„É£„ÉÉ„Ç∑„É•ÊäëÊ≠¢ÔºàGitHub Pages„Åß„ÇÇÂäπ„ÅèÁØÑÂõ≤„ÅßÔºâ -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{
  /* Êòé„Çã„ÇÅÈÖçËâ≤ */
  --bg1:#f5f9ff; --bg2:#eef6ff;
  --card:#ffffff; --line:#d9e6f6;
  --txt:#0b1b2b; --muted:#506172;
  --pri:#0ea5e9; --pri2:#22d3ee; --shadow:0 6px 18px rgba(13,97,160,.12);
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;font-family:Inter,system-ui,Segoe UI,Helvetica,Arial;
  background:linear-gradient(180deg,var(--bg1),var(--bg2)); color:var(--txt);}
.container{max-width:900px;margin:0 auto;padding:18px}
.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.brand{font-weight:700;letter-spacing:.2px}
.badge{color:#003244;background:linear-gradient(90deg,var(--pri),var(--pri2));
  padding:4px 10px;border-radius:999px;font-size:12px;font-weight:700}
.hello{color:var(--muted);margin:2px 0 14px}

.stepper{display:flex;gap:10px;margin:8px 0 16px}
.step{flex:1;background:#fff;border:1px solid var(--line);color:var(--muted);
  padding:10px 12px;border-radius:12px;display:flex;align-items:center;gap:8px;box-shadow:var(--shadow)}
.step.active{border-color:var(--pri); color:#024c66;
  background:linear-gradient(180deg,#ffffff,#f0fbff)}
.step .num{width:22px;height:22px;border-radius:999px;background:#eef7ff;
  display:grid;place-items:center;font-size:12px;color:#0678a3;font-weight:700}

.grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
@media(min-width:720px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}

.card{background:var(--card);border:1px solid var(--line);border-radius:14px;
  padding:14px;box-shadow:var(--shadow);transition:.15s transform}
.card:hover{transform:translateY(-2px)}
.card h3{margin:0 0 6px;font-size:16px}
.card p{margin:0;color:var(--muted);font-size:13px}

.chip{display:inline-block;padding:6px 10px;border-radius:999px;
  background:#e6f7ff;border:1px solid #bfeaff;color:#06678e;font-size:12px}
.btn{background:linear-gradient(90deg,var(--pri),var(--pri2));border:none;color:#003244;
  font-weight:700;padding:12px 14px;border-radius:10px;box-shadow:var(--shadow)}
.btn.secondary{background:#ffffff;color:#0b1b2b;border:1px solid var(--line)}

.section{background:var(--card);border:1px solid var(--line);border-radius:16px;
  padding:16px;box-shadow:var(--shadow)}
.section h2{margin:0 0 10px}

.row{display:flex;gap:10px;flex-wrap:wrap}
.item{flex:1 1 240px;border:1px dashed #b9d6ea;border-radius:10px;padding:10px;background:#fcfeff}
a.clean{color:inherit;text-decoration:none}
.mono{font-family:ui-monospace,Menlo,Consolas,monospace}
.small{font-size:12px;color:var(--muted)}
.hero{width:100%;border-radius:12px;margin:6px 0;aspect-ratio:16/9;object-fit:cover;border:1px solid var(--line)}
</style>
</head><body>
<div class="container">
  <div class="header">
    <div class="brand">üé£ RigNavi</div>
    <div class="badge">MVP</div>
  </div>
  <div id="hello" class="hello">Ëµ∑Âãï‰∏≠...</div>

  <div class="stepper">
    <div class="step" id="s1"><span class="num">1</span>Èá£„ÇäÂ†¥ÊâÄ</div>
    <div class="step" id="s2"><span class="num">2</span>È≠öÁ®Æ</div>
    <div class="step" id="s3"><span class="num">3</span>Èá£„ÇäÊñπ</div>
  </div>

  <div id="view"></div>
</div>

<script>
const LIFF_ID   = "2008257307-RwPLYWG1";
const VERSION   = "2";  // ‚Üê„Éá„Éó„É≠„Ç§„ÅÆ„Åü„Å≥„Å´‰∏ä„Åí„Çã
const LIFF_URL  = `https://liff.line.me/${LIFF_ID}?v=${VERSION}`;

// --- „Éá„Éº„ÇøÔºàÂøÖË¶Å„Å´Âøú„Åò„Å¶Â¢ó„ÇÑ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºâ ---
const DB = [
  { id:"teibo", name:"Ê∏Ø„ÉªÂ†§Èò≤", desc:"Â∏∏Â§úÁÅØ„ÇÑËßíÂú∞„ÄÅÂ§ñÂêë„Åç„ÉÜ„Éà„É©„Å™„Å©",
    fishes:[
      { id:"aji", name:"„Ç¢„Ç∏", desc:"Â§ï„Åæ„Åö„ÇÅ„ÄúÂ§ú„ÅÆÂõûÈÅä",
        methods:[
          { id:"sabiki", name:"„Çµ„Éì„Ç≠",
            plan:{
              title:"„Ç¢„Ç∏„ÅÆÊï∞Èá£„ÇäÔºàÂ†§Èò≤„Çµ„Éì„Ç≠Ôºâ",
              hero:"https://images.unsplash.com/photo-1524712245354-c8471b98e76c?q=80&w=1200&auto=format&fit=crop",
              point:"Â∏∏Â§úÁÅØ„ÅÆÊòéÊöóÂ¢É„ÉªË∂≥ÂÖÉÂõûÈÅä„ÅÆË°®Â±§„Äú‰∏≠Â±§",
              depth:"Ë°®Â±§„Äú‰∏≠Â±§Ôºà„Ç´„Ç¥„Çí1mÂàª„Åø„ÅßÊé¢„ÇãÔºâ",
              how:"10Âõû/ÂàÜ„ÅÆ„ÉÜ„É≥„Éù„Åß‰∏ä‰∏ã„ÄÇÁæ§„Çå„Åå‰ªò„ÅÑ„ÅüÂ±§„Çí„Ç≠„Éº„Éó„ÄÇ",
              gear:{ rig:"„Çµ„Éì„Ç≠6Êú¨ 4„Äú6Âè∑ + Â∞èÂûã„Ç´„Ç¥", line:"„Éä„Ç§„É≠„É≥2„Äú3Âè∑ / „Éè„É™„Çπ1.5Âè∑", option:"Â§ú„ÅØ„Ç±„ÉüÂ∞è„ÅßË¶ñË™çÊÄßUP" },
              parts:[
                {label:"„Éè„É§„Éñ„Çµ „Çµ„Éì„Ç≠5Âè∑", url:"https://www.amazon.co.jp/s?k=%E3%82%B5%E3%83%93%E3%82%AD+5%E5%8F%B7&tag=yourtag-22"},
                {label:"„Ç´„Ç¥Â∞è „Éä„ÇπÂûã8Âè∑", url:"https://www.amazon.co.jp/s?k=%E9%87%A3%E3%82%8A+%E3%82%AB%E3%82%B4+%E5%B0%8F&tag=yourtag-22"}
              ]
            }
          },
          { id:"uki", name:"„Ç¶„Ç≠",
            plan:{
              title:"ÈõªÊ∞ó„Ç¶„Ç≠„ÅßÂõûÈÅäÂæÖ„Å°",
              hero:"https://images.unsplash.com/photo-1508855901852-97c5b3b5b6cd?q=80&w=1200&auto=format&fit=crop",
              point:"Â∏∏Â§úÁÅØÂë®Ëæ∫„ÅÆÊΩÆ„ÅåÂäπ„ÅèÁ≠ã",
              depth:"1.0„Äú1.8m„ÅßÂæÆË™øÊï¥",
              how:"„Ç¶„Ç≠‰∏ã„Çí30cmÂàª„Åø„ÅßË™øÊï¥„ÄÇÊôÇ„ÄÖ„ÇÜ„Å£„Åè„ÇäÂºï„Åè„ÄÇ",
              gear:{ rig:"ÈõªÊ∞ó„Ç¶„Ç≠0.5„Äú1Âè∑", line:"„Éä„Ç§„É≠„É≥3Âè∑", option:"Ë™ò„ÅÑÁî®„Ç¨„É≥ÁéâG5" },
              parts:[
                {label:"ÈõªÊ∞ó„Ç¶„Ç≠ 1Âè∑", url:"https://www.amazon.co.jp/s?k=%E9%9B%BB%E6%B0%97%E3%82%A6%E3%82%AD+1%E5%8F%B7&tag=yourtag-22"},
                {label:"„Çµ„É´„Ç´„É≥/„Éè„É™„Çπ", url:"https://www.amazon.co.jp/s?k=%E3%82%B5%E3%83%AB%E3%82%AB%E3%83%B3+%E3%83%8F%E3%83%AA%E3%82%B9&tag=yourtag-22"}
              ]
            }
          }
        ]
      },
      { id:"mebaru", name:"„É°„Éê„É´", desc:"Â≤©Â†¥„Éª„Çπ„Éà„É©„ÇØ„ÉÅ„É£„ÉºÂë®„Çä",
        methods:[
          { id:"lure", name:"„É´„Ç¢„Éº",
            plan:{
              title:"Â∏∏Â§úÁÅØ„É°„Éê„É™„É≥„Ç∞",
              hero:"https://images.unsplash.com/photo-1558981285-6f0c94958bb6?q=80&w=1200&auto=format&fit=crop",
              point:"Â£ÅÈöõ/ÊòéÊöóÂ¢É/ÂèçËª¢ÊµÅ",
              depth:"Ë°®Â±§„Éâ„É™„Éï„Éà ‚Üí ‰∏≠Â±§„É¨„É≥„Ç∏„Ç≠„Éº„Éó",
              how:"1g„Ç∏„Ç∞„Éò„ÉÉ„ÉâÔºã„ÉØ„Éº„É†„ÅßË∂Ö„Çπ„É≠„ÉºÂ∑ª„Åç",
              gear:{ rig:"1g„Ç∏„Ç∞„Éò„ÉÉ„ÉâÔºã1.5in„ÉØ„Éº„É†", line:"PE0.2 + ÔæåÔæõÔæõ0.8", option:"„Çπ„Éä„ÉÉ„ÉóÂ∞è„Åß‰∫§ÊèõÊ•Ω„Å´" },
              parts:[
                {label:"1g „Ç∏„Ç∞„Éò„ÉÉ„Éâ", url:"https://www.amazon.co.jp/s?k=%E3%82%B8%E3%82%B0%E3%83%98%E3%83%83%E3%83%89+1g&tag=yourtag-22"},
                {label:"„É°„Éê„É´„ÉØ„Éº„É†1.5in", url:"https://www.amazon.co.jp/s?k=%E3%83%A1%E3%83%90%E3%83%AA+%E3%83%AF%E3%83%BC%E3%83%A0&tag=yourtag-22"}
              ]
            }
          }
        ]
      }
    ]
  },
  { id:"surf", name:"„Çµ„Éº„Éï", desc:"ÈÅ†ÊµÖ„ÅÆÁ†ÇÊµú„ÄÇÊâï„ÅÑÂá∫„Åó/Èõ¢Â≤∏ÊµÅ„ÅåÁãô„ÅÑÁõÆ",
    fishes:[
      { id:"hirame", name:"„Éí„É©„É°", desc:"ÊúùÂ§ï„Åæ„Åö„ÇÅ‰∏≠ÂøÉ",
        methods:[ { id:"lure", name:"„É´„Ç¢„Éº",
          plan:{
            title:"„Éï„É©„ÉÉ„Éà„Ç≤„Éº„É†Ôºà„Éü„Éé„Éº/„Ç∑„É≥„Éö„É≥Ôºâ",
            hero:"https://images.unsplash.com/photo-1455216205476-8e8b3410dde6?q=80&w=1200&auto=format&fit=crop",
            point:"Èõ¢Â≤∏ÊµÅ„ÅÆ„É®„É¨„ÉªÂú∞ÂΩ¢Â§âÂåñ„É©„Ç§„É≥",
            depth:"‰∏≠Â±§„Äú„Éú„Éà„É†‰ªòËøë",
            how:"„Åü„Å†Â∑ª„ÅçÔºãÊôÇ„ÄÖ„Çπ„Éà„ÉÉ„Éó„ÄÇÊ≥¢Êâì„Å°Èöõ„Åæ„ÅßÈÄö„Åô„ÄÇ",
            gear:{ rig:"30g„Ç∑„É≥„Éö„É≥/„Éü„Éé„Éº", line:"PE1.0 + ÔæåÔæõÔæõ4", option:"„Çπ„Éä„ÉÉ„Éó#1" },
            parts:[
              {label:"„Ç∑„É≥„Éö„É≥ 30g", url:"https://www.amazon.co.jp/s?k=%E3%82%B7%E3%83%B3%E3%83%9A%E3%83%B3+30g&tag=yourtag-22"},
              {label:"„Ç∑„Éß„ÉÉ„ÇØ„É™„Éº„ÉÄ„Éº4Âè∑", url:"https://www.amazon.co.jp/s?k=%E3%83%AA%E3%83%BC%E3%83%80%E3%83%BC+4%E5%8F%B7+%E3%83%95%E3%83%AD%E3%83%AD&tag=yourtag-22"}
            ]
          }
        } ]
      }
    ]
  }
];

// ====== Áä∂ÊÖã & „É´„Éº„ÉÜ„Ç£„É≥„Ç∞ ======
let state = {spot:null, fish:null, method:null};
function setState(part, val){
  state[part] = val;
  const hash = [state.spot?.id, state.fish?.id, state.method?.id].filter(Boolean).join('/');
  location.hash = hash ? `#${hash}` : '#';
  render();
}
function initFromHash(){
  const [sid,fid,mid] = (location.hash.replace('#','')||'').split('/');
  const spot   = DB.find(s=>s.id===sid);
  const fish   = spot?.fishes.find(f=>f.id===fid);
  const method = fish?.methods.find(m=>m.id===mid);
  state = {spot, fish, method};
}

// ====== „Éì„É•„Éº ======
const $view = document.getElementById('view');
function stepActive(n){ [1,2,3].forEach(i=>document.getElementById('s'+i).classList.toggle('active', i===n)); }

function viewSpots(){
  stepActive(1);
  $view.innerHTML = `<div class="grid">
    ${DB.map(s=>`<a class="clean" href="javascript:void(0)" onclick="pickSpot('${s.id}')">
      <div class="card"><h3>${s.name}</h3><p>${s.desc}</p></div></a>`).join('')}
  </div>`;
}
window.pickSpot = (sid)=>{ setState('spot', DB.find(s=>s.id===sid)); setState('fish',null); setState('method',null); };

function viewFish(){
  stepActive(2);
  const list = state.spot.fishes;
  $view.innerHTML = `<div class="section">
    <h2>${state.spot.name} <span class="chip">È≠öÁ®Æ„ÇíÈÅ∏„Å∂</span></h2>
    <div class="grid" style="margin-top:10px;">
      ${list.map(f=>`<a class="clean" href="javascript:void(0)" onclick="pickFish('${f.id}')">
        <div class="card"><h3>${f.name}</h3><p>${f.desc}</p></div></a>`).join('')}
    </div>
    <div class="small" style="margin-top:10px">Êàª„Çã: <a class="clean mono" href="javascript:setState('spot',null)">#TOP</a></div>
  </div>`;
}
window.pickFish = (fid)=>{ setState('fish', state.spot.fishes.find(f=>f.id===fid)); setState('method',null); };

function viewMethods(){
  stepActive(3);
  const list = state.fish.methods;
  $view.innerHTML = `<div class="section">
    <h2>${state.spot.name} ‚Ä∫ ${state.fish.name} <span class="chip">Èá£„ÇäÊñπ„ÇíÈÅ∏„Å∂</span></h2>
    <div class="grid" style="margin-top:10px;">
      ${list.map(m=>`<a class="clean" href="javascript:void(0)" onclick="pickMethod('${m.id}')">
        <div class="card"><h3>${m.name}</h3><p>${m.plan.title}</p></div></a>`).join('')}
    </div>
  </div>`;
}
window.pickMethod = (mid)=>{ setState('method', state.fish.methods.find(m=>m.id===mid)); };

function viewPlan(){
  const {spot, fish, method} = state; const p = method.plan;
  $view.innerHTML = `
    <div class="section">
      <div class="small">„É´„Éº„Éà: <span class="mono">#${spot.id}/${fish.id}/${method.id}</span></div>
      <h2 style="margin-top:6px">${spot.name} ‚Ä∫ ${fish.name} ‚Ä∫ <span class="chip">${method.name}</span></h2>
      <img class="hero" src="${p.hero}" alt="">
      <div class="row">
        <div class="item"><b>Áãô„ÅÜ„Éù„Ç§„É≥„Éà</b><br>${p.point}</div>
        <div class="item"><b>Áãô„ÅÜÊ£ö</b><br>${p.depth}</div>
        <div class="item"><b>Êîª„ÇÅÊñπ„ÅÆ„Ç≥„ÉÑ</b><br>${p.how}</div>
      </div>
      <div class="row" style="margin-top:10px">
        <div class="item"><b>‰ªïÊéõ„Åë</b><br>${p.gear.rig}</div>
        <div class="item"><b>„É©„Ç§„É≥</b><br>${p.gear.line}</div>
        <div class="item"><b>„Ç™„Éó„Ç∑„Éß„É≥</b><br>${p.gear.option||'-'}</div>
      </div>
      <h3 style="margin:14px 0 8px">„Åä„Åô„Åô„ÇÅÈÉ®Êùê</h3>
      <div class="grid">
        ${p.parts.map(it=>`<div class="card">
          <h3>${it.label}</h3><p class="small">Amazon„ÅßË©≥Á¥∞„ÇíÁ¢∫Ë™ç</p>
          <button class="btn" onclick="ext('${it.url}')">Amazon„ÅßË¶ã„Çã</button>
        </div>`).join('')}
      </div>
      <div style="display:flex; gap:8px; margin-top:14px">
        <button class="btn secondary" onclick="historyBack()">Êàª„Çã</button>
        <button class="btn" onclick="sharePlan()">Âèã„Å†„Å°„Å´ÂÖ±Êúâ</button>
      </div>
    </div>`;
}
window.ext = (url)=> liff.openWindow({ url, external:true });
window.historyBack = ()=>{ if(state.method){ setState('method',null); } else if(state.fish){ setState('fish',null);} else { setState('spot',null);} };

function sharePlan(){
  const {spot, fish, method} = state; const p = method.plan;
  if(!liff.isApiAvailable('shareTargetPicker')){ alert('ÂÖ±Êúâ„ÅØLINE„Ç¢„Éó„É™„Åã„Çâ'); return; }
  const btns = [
    {type:"button", style:"primary", action:{type:"uri", label:"Amazon„ÅßË¶ã„Çã", uri:p.parts[0]?.url || LIFF_URL}},
    {type:"button", style:"secondary", action:{type:"uri", label:"RigNavi„ÅßÈñã„Åè", uri:`${LIFF_URL}#${spot.id}/${fish.id}/${method.id}`}}
  ];
  if(p.parts[1]) btns.unshift({type:"button", style:"primary", action:{type:"uri", label:"„ÇÇ„ÅÜ1‰ª∂", uri:p.parts[1].url}});
  const flex = {
    type:"bubble",
    hero:{type:"image",url:p.hero,size:"full",aspectMode:"cover",aspectRatio:"16:9"},
    body:{type:"box",layout:"vertical",contents:[
      {type:"text",text:p.title,weight:"bold",wrap:true},
      {type:"text",text:`Â†¥ÊâÄ:${spot.name} / È≠ö:${fish.name} / Èá£Ê≥ï:${method.name}`,size:"sm",color:"#666666",wrap:true,margin:"sm"},
      {type:"text",text:`„Éù„Ç§„É≥„Éà:${p.point}`,wrap:true,size:"sm",margin:"md"},
      {type:"text",text:`Ê£ö:${p.depth}`,wrap:true,size:"sm"},
    ]},
    footer:{type:"box",layout:"vertical",spacing:"md",contents:btns}
  };
  liff.shareTargetPicker([{type:"flex",altText:p.title,contents:flex}]);
}

// ====== ÁîªÈù¢ÂàáÊõø ======
function render(){
  const s = state;
  document.getElementById('s1').classList.toggle('active',!s.spot);
  document.getElementById('s2').classList.toggle('active',s.spot && !s.fish);
  document.getElementById('s3').classList.toggle('active',s.fish && !s.method);
  if(!s.spot) return viewSpots();
  if(!s.fish) return viewFish();
  if(!s.method) return viewMethods();
  return viewPlan();
}

// ====== Ëµ∑Âãï ======
(async()=>{
  await liff.init({ liffId: LIFF_ID });
  if(!liff.isLoggedIn()){ liff.login({prompt:'consent'}); return; }
  try{ const p=await liff.getProfile(); document.getElementById('hello').textContent=`„Çà„ÅÜ„Åì„Åù ${p.displayName} „Åï„Çì`; }
  catch{ document.getElementById('hello').textContent='„Çà„ÅÜ„Åì„ÅùÔºÅ'; }
  initFromHash(); render();
})();
window.addEventListener('hashchange',()=>{ initFromHash(); render();});
</script>
</body></html>
